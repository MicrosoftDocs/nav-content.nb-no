---
title: "Designdetaljer - Bokføringsstruktur for varesporing"
description: "Lær hvordan du bruker vareposter som den hovedbærer av varesporingsnumre."
documentationcenter: 
author: SorenGP
ms.prod: dynamics-nav-2017
ms.topic: article
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.search.keywords: design, item tracking, posting, inventory
ms.date: 07/01/2017
ms.author: sgroespe
ms.translationtype: HT
ms.sourcegitcommit: 4fefaef7380ac10836fcac404eea006f55d8556f
ms.openlocfilehash: f31c9da412b4411cc8b104e59d1255456d096794
ms.contentlocale: nb-no
ms.lasthandoff: 10/16/2017

---
# <a name="design-details-item-tracking-posting-structure"></a><span data-ttu-id="9cd5f-103">Designdetaljer: Bokføringsstruktur for varesporing</span><span class="sxs-lookup"><span data-stu-id="9cd5f-103">Design Details: Item Tracking Posting Structure</span></span>
<span data-ttu-id="9cd5f-104">Vareposter brukes som hovedbærere av varesporingsnumre, slik at de passer med funksjonene for kostberegning for beholdning og gir en enklere og mer robust løsning.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-104">To align with inventory costing functionality and to obtain a simpler and more robust solution, item ledger entries are used as the primary carrier of item tracking numbers.</span></span>  
  
<span data-ttu-id="9cd5f-105">Varesporingsnumre i ordrenettverksenheter og ikke-ordrenettverksenheter er angitt i tabellen **Reservasjonspost** (T337).</span><span class="sxs-lookup"><span data-stu-id="9cd5f-105">Item tracking numbers on order network entities and non-order network entities are specified in the **Reservation Entry** table (T337).</span></span> <span data-ttu-id="9cd5f-106">Varesporingsnumre som er knyttet til historisk informasjon, blir hentet direkte fra vareposter som er knyttet til den aktuelle transaksjonen.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-106">Item tracking numbers that are related to historical information are retrieved directly from the item ledger entries that are related to the transaction in question.</span></span> <span data-ttu-id="9cd5f-107">Dette betyr at vareposter gjenspeiler varesporingsspesifikasjonen for den bokførte ordrelinjen.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-107">This means that item ledger entries reflect the item tracking specification of the posted order line.</span></span>  
  
<span data-ttu-id="9cd5f-108">Vinduet **Varesporingslinjer** henter informasjonen fra T337 og varepostene og viser den via den midlertidige tabellen **Sporingsspesifikasjon** (T336).</span><span class="sxs-lookup"><span data-stu-id="9cd5f-108">The **Item Tracking Lines** window retrieves the information from T337 and the item ledger entries and shows it through the temporary table, **Tracking Specification** (T336).</span></span> <span data-ttu-id="9cd5f-109">T336 inneholder også de midlertidige dataene i vinduet **Varesporingslinjer** for varesporingsantall som skal faktureres.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-109">T336 also hold the temporary data in the **Item Tracking Lines window** for item tracking quantities that remain to be invoiced.</span></span>  
  
## <a name="one-to-many-relation"></a><span data-ttu-id="9cd5f-110">Én-til-mange-relasjon</span><span class="sxs-lookup"><span data-stu-id="9cd5f-110">One-to-Many Relation</span></span>  
<span data-ttu-id="9cd5f-111">Tabellen **Vareposttilknytning**, som brukes til å koble en bokført dokumentlinje til de tilknyttede varepostene, består av to hoveddeler:</span><span class="sxs-lookup"><span data-stu-id="9cd5f-111">The **Item Entry Relation** table, which is used to link a posted document line with its related item ledger entries, consists of two main parts:</span></span>  
  
* <span data-ttu-id="9cd5f-112">En peker til den posterte dokumentlinjen, **Ordrelinjenr.**-feltet</span><span class="sxs-lookup"><span data-stu-id="9cd5f-112">A pointer to the posted document line, the **Order Line No.**</span></span> <span data-ttu-id="9cd5f-113">.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-113">field.</span></span>  
* <span data-ttu-id="9cd5f-114">Et løpenummer peker til en varepost, feltet **Vareløpenr.**.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-114">An entry number pointing to an item ledger entry, the **Item Entry No.** field.</span></span>  
  
<span data-ttu-id="9cd5f-115">Funksjonaliteten til det eksisterende **Postnr.**-feltet, som knytter en varepost til en bokført dokumentlinje, håndterer den vanlige én-til-én-relasjonen når ingen varesporingsnumre er på den bokførte dokumentlinjen.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-115">The functionality of the existing **Entry No.** field, which relates an item ledger entry to a posted document line, handles the typical one-to-one relation when no item tracking numbers exist on the posted document line.</span></span> <span data-ttu-id="9cd5f-116">Hvis det finnes varesporingsnumre, vil **Løpenummer**-feltet forbli tomt, og en-til-mange-relasjonen behandles av tabellen **Vareposttilknytning**.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-116">If item tracking numbers exist, then the **Entry No.** field is left blank, and the one-to-many relation is handled by the **Item Entry Relation** table.</span></span> <span data-ttu-id="9cd5f-117">Hvis den bokførte dokumentlinjen inneholder varesporingsnumre, men bare er knyttet til en enkelt varepost, vil **Løpenummer**-feltet håndterer tilknytningen, og ingen oppføringen blir opprettet i tabellen **Vareposttilknytning**.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-117">If the posted document line carries item tracking numbers but only relates to a single item ledger entry, then the **Entry No.** field handles the relation, and the no record is created in the **Item Entry Relation** table.</span></span>  
  
## <a name="codeunits-80-and-90"></a><span data-ttu-id="9cd5f-118">Kodeenhet 80 og 90</span><span class="sxs-lookup"><span data-stu-id="9cd5f-118">Codeunits 80 and 90</span></span>  
<span data-ttu-id="9cd5f-119">For å få varepostene delt ved bokføring omsluttes koden i kodeenhet 80 og kodeenhet 90 med løkker som går gjennom globale, midlertidige postvariabler.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-119">To split the item ledger entries during posting, the code in codeunit 80 and codeunit 90, is encircled by loops that run through global temporary record variables.</span></span> <span data-ttu-id="9cd5f-120">Denne koden kaller kodeenhet 22 med en varekladdelinje.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-120">This code calls codeunit 22 with an item journal line.</span></span> <span data-ttu-id="9cd5f-121">Disse variablene initialiseres når varesporingsnumre finnes for dokumentlinjen.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-121">These variables are initialized when item tracking numbers exist for the document line.</span></span> <span data-ttu-id="9cd5f-122">Denne sløyfestrukturen brukes alltid for å holde koden enkel.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-122">To keep the code simple, this looping structure is always used.</span></span> <span data-ttu-id="9cd5f-123">Hvis det ikke finnes varesporingsnumre for dokumentlinjen, vil det settes inn en enkeltpost, og løkken kjøres bare én gang.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-123">If no item tracking numbers exist for the document line, then a single record is inserted, and the loop runs only once.</span></span>  
  
## <a name="posting-the-item-journal"></a><span data-ttu-id="9cd5f-124">Bokføre varekladden</span><span class="sxs-lookup"><span data-stu-id="9cd5f-124">Posting the Item Journal</span></span>  
<span data-ttu-id="9cd5f-125">Varesporingsnumre overføres via reservasjonspostene som er knyttet til vareposten, og gjennomgang av varesporingsnumre foretas i kodeenhet 22.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-125">Item tracking numbers are transferred via the reservation entries that relate to the item ledger entry, and the looping through item tracking numbers occurs in codeunit 22.</span></span> <span data-ttu-id="9cd5f-126">Dette konseptet fungerer på samme måte som når en varekladdelinje indirekte brukes til å bokføre et salg eller en bestilling som når en varekladdelinje brukes direkte.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-126">This concept works in the same way when an item journal line is used indirectly to post a sale or purchase order as when an item journal line is used directly.</span></span> <span data-ttu-id="9cd5f-127">Når varekladden brukes direkte, peker feltet **Kilderad-ID** mot selve varekladdelinjen.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-127">When the item journal is used directly, the **Source Row ID** field points to the item journal line itself.</span></span>  
  
## <a name="code-unit-22"></a><span data-ttu-id="9cd5f-128">Kodeenhet 22</span><span class="sxs-lookup"><span data-stu-id="9cd5f-128">Code Unit 22</span></span>  
<span data-ttu-id="9cd5f-129">Kodeenhet 80 og 90 går gjennom kodeenhet 22-kall under fakturabokføring av varesporingsnumre og under fakturering av eksisterende leveringer og mottak.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-129">Codeunits 80 and 90 loop the call of codeunit 22 during the invoice posting of item tracking numbers and during the invoicing of existing shipments or receipts.</span></span>  
  
<span data-ttu-id="9cd5f-130">Under antallsbokføring av varesporingsnumre, henter kodeenhet 22 varesporingsnumre fra postene i T337 som er knyttet til posteringen.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-130">During quantity posting of item tracking numbers, codeunit 22 retrieves item tracking numbers from the entries in T337 that relate to the posting.</span></span> <span data-ttu-id="9cd5f-131">Disse postene plasseres direkte på varekladdelinjen.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-131">These entries are placed directly on the item journal line.</span></span>  
  
<span data-ttu-id="9cd5f-132">Kodeenhet 22 går gjennom varesporingsnumrene og deler opp posteringen i de respektive varepostene som inneholder varesporingsnumrene.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-132">Codeunit 22 loops through the item tracking numbers and splits the posting into the respective item ledger entries that carry the item tracking numbers.</span></span> <span data-ttu-id="9cd5f-133">Informasjon om hvilke vareposter som opprettes, returneres til T337 ved hjelp av en midlertidig T336-post, som kalles opp av en prosedyre i kodeenhet 22.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-133">Information about which item ledger entries are created is returned to T337 by using a temporary T336 record, which is called by a procedure in codeunit 22.</span></span> <span data-ttu-id="9cd5f-134">Dette utløses når kodeenhet 22 har fullført sin kjøring, fordi på dette tidspunktet inneholder kodeenhet 22-objektet informasjonen.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-134">This procedure is triggered when codeunit 22 has finished its run because at that point, the codeunit 22 object contains the information.</span></span> <span data-ttu-id="9cd5f-135">Når den midlertidige T336-posten hentes, oppretter kodeenhet 80 og 90 poster i tabellen **Vareposttilknytning** for å knytte de opprettede varepostene til den opprettede følgeseddel- eller mottakslinjen.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-135">When the temporary T336 record is retrieved, codeunits 80 and 90 create records in the **Item Entry Relation** table to link the created item ledger entries to the created shipment or receipt line.</span></span> <span data-ttu-id="9cd5f-136">Kodeenhet 80 eller 90 konverterer deretter de midlertidige T336-postene til virkelige T336-poster som er knyttet til den aktuelle linjen.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-136">Codeunits 80 or codeunit 90 then converts the temporary T336 records to real T336 records that are related to the line in question.</span></span> <span data-ttu-id="9cd5f-137">Denne konverteringen skjer imidlertid bare hvis den bokførte dokumentlinjen ikke slettes, fordi den er bare delvis bokført.</span><span class="sxs-lookup"><span data-stu-id="9cd5f-137">However, this conversion occurs only if the posted document line is not deleted, because it is only partially posted.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9cd5f-138">Se også</span><span class="sxs-lookup"><span data-stu-id="9cd5f-138">See Also</span></span>  
<span data-ttu-id="9cd5f-139">[Designdetaljer: Varesporing](design-details-item-tracking.md) </span><span class="sxs-lookup"><span data-stu-id="9cd5f-139">[Design Details: Item Tracking](design-details-item-tracking.md) </span></span>  
[<span data-ttu-id="9cd5f-140">Designdetaljer: Varesporingsutforming</span><span class="sxs-lookup"><span data-stu-id="9cd5f-140">Design Details: Item Tracking Design</span></span>](design-details-item-tracking-design.md)
